<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4CAF50">
    <title>ë¯¸í™” í’ˆëª© ì œì¶œ ì‹œìŠ¤í…œ (ìŠ¤ë§ˆíŠ¸ ì§‘ê³„)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ë¯¸í™” í’ˆëª© ì œì¶œ ì‹œìŠ¤í…œ</h1>
            <p>ì œì¶œí•˜ë©´ ìë™ìœ¼ë¡œ ì´ ìˆ˜ëŸ‰ì´ ê³„ì‚°ë©ë‹ˆë‹¤!</p>
        </header>

        <!-- ë©”ë‰´ ë²„íŠ¼ë“¤ -->
        <div class="menu-buttons" style="display: flex; gap: 10px; justify-content: center; margin-bottom: 30px; flex-wrap: wrap;">
            <button type="button" class="btn btn-primary" onclick="showForm()">ìƒˆ ì‹ ì²­</button>
            <button type="button" class="btn btn-secondary" onclick="showAllSubmissions()">ì „ì²´ í˜„í™©</button>
            <button type="button" class="btn btn-secondary" onclick="showSummary()">ì´ ìˆ˜ëŸ‰</button>
        </div>

        <!-- ì‹ ì²­ í¼ -->
        <div id="formSection">
            <form id="itemForm">
                <div class="form-group">
                    <label for="name">ì‹ ì²­ì ì´ë¦„:</label>
                    <input type="text" id="name" name="name" required placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="name">
                </div>

                <div class="form-group">
                    <label for="department">ë¶€ì„œ/íŒ€:</label>
                    <input type="text" id="department" name="department" required placeholder="ë¶€ì„œëª…ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="organization">
                </div>

                <div class="items-section">
                    <h3>í•„ìš”í•œ í’ˆëª©</h3>
                    
                    <div class="item-row">
                        <label for="envelope">ë´‰íˆ¬:</label>
                        <input type="number" id="envelope" name="envelope" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ê°œ</span>
                    </div>

                    <div class="item-row">
                        <label for="rag">ê±¸ë ˆ:</label>
                        <input type="number" id="rag" name="rag" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ê°œ</span>
                    </div>

                    <div class="item-row">
                        <label for="bleach">ë½ìŠ¤:</label>
                        <input type="number" id="bleach" name="bleach" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ë³‘</span>
                    </div>

                    <div class="item-row">
                        <label for="detergent">ì„¸ì œ:</label>
                        <input type="number" id="detergent" name="detergent" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ë³‘</span>
                    </div>

                    <div class="item-row">
                        <label for="tissue">íœ´ì§€:</label>
                        <input type="number" id="tissue" name="tissue" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ë¡¤</span>
                    </div>

                    <div class="item-row">
                        <label for="trashbag">ì“°ë ˆê¸°ë´‰íˆ¬:</label>
                        <input type="number" id="trashbag" name="trashbag" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ê°œ</span>
                    </div>

                    <div class="item-row">
                        <label for="gloves">ì¥ê°‘:</label>
                        <input type="number" id="gloves" name="gloves" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ì¼¤ë ˆ</span>
                    </div>

                    <div class="item-row">
                        <label for="broom">ë¹—ìë£¨:</label>
                        <input type="number" id="broom" name="broom" min="0" value="0" class="quantity-input" inputmode="numeric" pattern="[0-9]*">
                        <span class="unit">ê°œ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="memo">ë¹„ê³ :</label>
                    <textarea id="memo" name="memo" placeholder="ì¶”ê°€ ìš”ì²­ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì…ë ¥í•´ì£¼ì„¸ìš”" rows="3"></textarea>
                </div>

                <div class="button-group">
                    <button type="submit" class="btn btn-primary">ì œì¶œí•˜ê¸°</button>
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">ë‹¤ì‹œ ì‘ì„±</button>
                </div>
            </form>
        </div>

        <!-- ì œì¶œ ì™„ë£Œ í™”ë©´ (ìŠ¤í¬ë¦°ìƒ·ìš©) -->
        <div id="resultSection" class="hidden" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
            <div style="text-align: center;">
                <h2>ğŸ‰ ì œì¶œ ì™„ë£Œ!</h2>
                <div id="submissionCard" style="background: white; color: #333; padding: 25px; border-radius: 12px; margin: 20px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="color: #4CAF50; margin-bottom: 15px;">ğŸ“‹ ë¯¸í™” í’ˆëª© ì‹ ì²­ì„œ</h3>
                    <div id="submissionDetails" style="text-align: left; font-size: 18px; line-height: 1.8;"></div>
                    <div style="text-align: center; margin-top: 20px; padding-top: 15px; border-top: 2px dashed #eee;">
                        <small style="color: #666;">ğŸ“± ì´ í™”ë©´ì„ ìº¡ì²˜í•´ì„œ ë‹¨í†¡ë°©ì— ì˜¬ë ¤ì£¼ì„¸ìš”!</small>
                    </div>
                </div>
                
                <div class="button-group" style="margin-top: 25px;">
                    <button type="button" class="btn btn-primary" onclick="captureAndShare()" style="background: #fff; color: #667eea; border: 2px solid #fff;">ğŸ“¸ ìº¡ì²˜ ì•ˆë‚´</button>
                    <button type="button" class="btn btn-secondary" onclick="showSummary()" style="background: transparent; border: 2px solid #fff;">ì´ ìˆ˜ëŸ‰ ë³´ê¸°</button>
                    <button type="button" class="btn btn-secondary" onclick="newSubmission()" style="background: transparent; border: 2px solid #fff;">ìƒˆ ì‹ ì²­</button>
                </div>
            </div>
        </div>

        <!-- ì „ì²´ ì‹ ì²­ í˜„í™© -->
        <div id="allSection" class="hidden">
            <h2>ğŸ“Š ì „ì²´ ì‹ ì²­ í˜„í™©</h2>
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p><strong>ì´ ì‹ ì²­ì:</strong> <span id="totalPeople">0</span>ëª…</p>
                <p><strong>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:</strong> <span id="lastUpdate">-</span></p>
            </div>
            
            <div id="submissionsList"></div>
            
            <div class="button-group">
                <button type="button" class="btn btn-primary" onclick="showSummary()">ğŸ“Š ì´ ìˆ˜ëŸ‰ ë³´ê¸°</button>
                <button type="button" class="btn btn-secondary" onclick="showForm()">ìƒˆ ì‹ ì²­</button>
                <button type="button" class="btn btn-print" onclick="printAll()">ì „ì²´ ì¸ì‡„</button>
            </div>
        </div>

        <!-- ì´ ìˆ˜ëŸ‰ ìš”ì•½ -->
        <div id="summarySection" class="hidden">
            <h2>ğŸ§® ì´ ìˆ˜ëŸ‰ ìš”ì•½</h2>
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p><strong>ğŸ’¡ êµ¬ë§¤ ë‹´ë‹¹ììš©:</strong> ì•„ë˜ ìˆ˜ëŸ‰ìœ¼ë¡œ ì£¼ë¬¸í•˜ì‹œë©´ ë©ë‹ˆë‹¤!</p>
            </div>
            
            <div class="summary-section">
                <h3>ğŸ“¦ êµ¬ë§¤í•´ì•¼ í•  ì´ ìˆ˜ëŸ‰</h3>
                <div id="totalSummary" class="total-summary-grid"></div>
            </div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <h4>ğŸ“‹ ìƒì„¸ ë‚´ì—­</h4>
                <div id="detailedBreakdown"></div>
            </div>
            
            <div class="button-group">
                <button type="button" class="btn btn-print" onclick="printSummary()">ğŸ“„ êµ¬ë§¤ ëª©ë¡ ì¸ì‡„</button>
                <button type="button" class="btn btn-secondary" onclick="showAllSubmissions()">ì „ì²´ í˜„í™©</button>
                <button type="button" class="btn btn-secondary" onclick="showForm()">ìƒˆ ì‹ ì²­</button>
            </div>
        </div>
    </div>

    <script>
        const ITEM_INFO = {
            envelope: 'ë´‰íˆ¬',
            rag: 'ê±¸ë ˆ',
            bleach: 'ë½ìŠ¤',
            detergent: 'ì„¸ì œ',
            tissue: 'íœ´ì§€',
            trashbag: 'ì“°ë ˆê¸°ë´‰íˆ¬',
            gloves: 'ì¥ê°‘',
            broom: 'ë¹—ìë£¨'
        };

        const ITEM_UNITS = {
            envelope: 'ê°œ',
            rag: 'ê°œ',
            bleach: 'ë³‘',
            detergent: 'ë³‘',
            tissue: 'ë¡¤',
            trashbag: 'ê°œ',
            gloves: 'ì¼¤ë ˆ',
            broom: 'ê°œ'
        };

        let submissions = [];

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('itemForm').addEventListener('submit', handleSubmit);
            loadSubmissions();
            showForm();
        });

        // í¼ ì œì¶œ ì²˜ë¦¬
        function handleSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData);
            
            // ê²€ì¦
            if (!data.name.trim() || !data.department.trim()) {
                alert('ì´ë¦„ê³¼ ë¶€ì„œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const hasItems = Object.keys(ITEM_INFO).some(key => parseInt(data[key]) > 0);
            if (!hasItems) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ í’ˆëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë°ì´í„° ì €ì¥
            const submission = {
                ...data,
                id: Date.now().toString(),
                timestamp: new Date().toLocaleString('ko-KR'),
                date: new Date().toLocaleDateString('ko-KR')
            };
            
            submissions.push(submission);
            saveSubmissions();
            showResult(submission);
        }

        // ì œì¶œ ì™„ë£Œ í™”ë©´ í‘œì‹œ
        function showResult(submission) {
            hideAllSections();
            document.getElementById('resultSection').classList.remove('hidden');
            
            const items = [];
            Object.keys(ITEM_INFO).forEach(key => {
                if (parseInt(submission[key]) > 0) {
                    items.push(`${ITEM_INFO[key]} ${submission[key]}${ITEM_UNITS[key]}`);
                }
            });
            
            document.getElementById('submissionDetails').innerHTML = `
                <div style="margin-bottom: 12px;">
                    <strong>ğŸ‘¤ ì‹ ì²­ì:</strong> ${submission.name}
                </div>
                <div style="margin-bottom: 12px;">
                    <strong>ğŸ¢ ë¶€ì„œ:</strong> ${submission.department}
                </div>
                <div style="margin-bottom: 12px;">
                    <strong>ğŸ“… ì‹ ì²­ì¼:</strong> ${submission.date}
                </div>
                <div style="margin-bottom: 12px;">
                    <strong>ğŸ“¦ ì‹ ì²­ í’ˆëª©:</strong><br>
                    ${items.map(item => `&nbsp;&nbsp;â€¢ ${item}`).join('<br>')}
                </div>
                ${submission.memo ? `<div style="margin-bottom: 12px;"><strong>ğŸ“ ë¹„ê³ :</strong> ${submission.memo}</div>` : ''}
                <div style="font-size: 14px; color: #666;">
                    <strong>â° ì œì¶œì‹œê°„:</strong> ${submission.timestamp}
                </div>
            `;
        }

        // ì „ì²´ í˜„í™© í‘œì‹œ
        function showAllSubmissions() {
            hideAllSections();
            document.getElementById('allSection').classList.remove('hidden');
            
            document.getElementById('totalPeople').textContent = submissions.length;
            document.getElementById('lastUpdate').textContent = submissions.length > 0 ? 
                submissions[submissions.length - 1].timestamp : '-';
            
            let html = '';
            submissions.forEach((submission, index) => {
                const items = [];
                Object.keys(ITEM_INFO).forEach(key => {
                    if (parseInt(submission[key]) > 0) {
                        items.push(`${ITEM_INFO[key]} ${submission[key]}${ITEM_UNITS[key]}`);
                    }
                });
                
                html += `
                    <div class="submission-item" style="margin-bottom: 15px; padding: 20px; background: white; border-radius: 10px; border: 2px solid #e0e0e0;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; color: #2E7D32;">${submission.name} (${submission.department})</h4>
                            <div>
                                <button onclick="editSubmission(${index})" class="btn btn-secondary" style="padding: 5px 10px; font-size: 14px; margin-right: 5px;">ìˆ˜ì •</button>
                                <button onclick="deleteSubmission(${index})" class="btn btn-secondary" style="padding: 5px 10px; font-size: 14px; background: #f44336; color: white;">ì‚­ì œ</button>
                            </div>
                        </div>
                        <p style="margin: 5px 0;"><strong>í’ˆëª©:</strong> ${items.join(', ')}</p>
                        ${submission.memo ? `<p style="margin: 5px 0; font-style: italic; color: #666;"><strong>ë¹„ê³ :</strong> ${submission.memo}</p>` : ''}
                        <small style="color: #666;">${submission.timestamp}</small>
                    </div>
                `;
            });
            
            document.getElementById('submissionsList').innerHTML = html || 
                '<p style="text-align: center; color: #666; padding: 40px;">ì•„ì§ ì‹ ì²­ëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        }

        // ì´ ìˆ˜ëŸ‰ ìš”ì•½ í‘œì‹œ
        function showSummary() {
            hideAllSections();
            document.getElementById('summarySection').classList.remove('hidden');
            
            const totals = {};
            const breakdown = {};
            
            // ì´ ìˆ˜ëŸ‰ ê³„ì‚°
            submissions.forEach(submission => {
                Object.keys(ITEM_INFO).forEach(key => {
                    const quantity = parseInt(submission[key]) || 0;
                    if (quantity > 0) {
                        totals[key] = (totals[key] || 0) + quantity;
                        
                        if (!breakdown[key]) breakdown[key] = [];
                        breakdown[key].push(`${submission.name}: ${quantity}${ITEM_UNITS[key]}`);
                    }
                });
            });
            
            // ì´ ìˆ˜ëŸ‰ í‘œì‹œ
            let summaryHtml = '';
            Object.keys(ITEM_INFO).forEach(key => {
                if (totals[key] > 0) {
                    summaryHtml += `
                        <div class="total-item" style="background: white; padding: 20px; border-radius: 10px; text-align: center; border: 2px solid #4CAF50;">
                            <div class="item-name" style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">${ITEM_INFO[key]}</div>
                            <div class="item-total" style="font-size: 32px; color: #4CAF50; font-weight: bold;">${totals[key]}${ITEM_UNITS[key]}</div>
                        </div>
                    `;
                }
            });
            
            document.getElementById('totalSummary').innerHTML = summaryHtml || 
                '<p style="text-align: center; color: #666;">ì‹ ì²­ëœ í’ˆëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            
            // ìƒì„¸ ë‚´ì—­ í‘œì‹œ
            let detailHtml = '';
            Object.keys(ITEM_INFO).forEach(key => {
                if (breakdown[key]) {
                    detailHtml += `
                        <div style="margin-bottom: 20px;">
                            <h5 style="color: #4CAF50; margin-bottom: 8px;">${ITEM_INFO[key]} (ì´ ${totals[key]}${ITEM_UNITS[key]})</h5>
                            <ul style="margin: 0; padding-left: 20px;">
                                ${breakdown[key].map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
            });
            
            document.getElementById('detailedBreakdown').innerHTML = detailHtml || 
                '<p style="color: #666;">ì‹ ì²­ëœ í’ˆëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        }

        // ì‹ ì²­ ìˆ˜ì •
        function editSubmission(index) {
            const submission = submissions[index];
            
            // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
            document.getElementById('name').value = submission.name;
            document.getElementById('department').value = submission.department;
            document.getElementById('memo').value = submission.memo || '';
            
            Object.keys(ITEM_INFO).forEach(key => {
                document.getElementById(key).value = submission[key] || 0;
            });
            
            // ê¸°ì¡´ ì‹ ì²­ ì‚­ì œ
            submissions.splice(index, 1);
            saveSubmissions();
            
            showForm();
            alert('ìˆ˜ì • ëª¨ë“œì…ë‹ˆë‹¤. ë‹¤ì‹œ ì œì¶œí•´ì£¼ì„¸ìš”.');
        }

        // ì‹ ì²­ ì‚­ì œ
        function deleteSubmission(index) {
            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                submissions.splice(index, 1);
                saveSubmissions();
                showAllSubmissions();
            }
        }

        // ì„¹ì…˜ í‘œì‹œ í•¨ìˆ˜ë“¤
        function hideAllSections() {
            document.getElementById('formSection').style.display = 'none';
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('allSection').classList.add('hidden');
            document.getElementById('summarySection').classList.add('hidden');
        }

        function showForm() {
            hideAllSections();
            document.getElementById('formSection').style.display = 'block';
        }

        function newSubmission() {
            showForm();
            resetForm();
        }

        function resetForm() {
            document.getElementById('itemForm').reset();
        }

        function captureAndShare() {
            alert('ğŸ“± ìŠ¤í¬ë¦°ìƒ· ì°ëŠ” ë°©ë²•:\n\nì•ˆë“œë¡œì´ë“œ: ì „ì› ë²„íŠ¼ + ë³¼ë¥¨ ë‹¤ìš´ ë²„íŠ¼\niPhone: ì‚¬ì´ë“œ ë²„íŠ¼ + ë³¼ë¥¨ ì—… ë²„íŠ¼\n\nìº¡ì²˜í•œ ì´ë¯¸ì§€ë¥¼ ë‹¨í†¡ë°©ì— ì˜¬ë ¤ì£¼ì„¸ìš”!');
        }

        // ë°ì´í„° ì €ì¥/ë¡œë“œ
        function saveSubmissions() {
            localStorage.setItem('cleaningSubmissions', JSON.stringify(submissions));
        }

        function loadSubmissions() {
            submissions = JSON.parse(localStorage.getItem('cleaningSubmissions') || '[]');
        }

        // ì¸ì‡„ í•¨ìˆ˜ë“¤
        function printSummary() {
            const totals = {};
            submissions.forEach(submission => {
                Object.keys(ITEM_INFO).forEach(key => {
                    const quantity = parseInt(submission[key]) || 0;
                    if (quantity > 0) {
                        totals[key] = (totals[key] || 0) + quantity;
                    }
                });
            });
            
            let printContent = `
                <h1>ğŸ“¦ ë¯¸í™” í’ˆëª© êµ¬ë§¤ ëª©ë¡</h1>
                <p><strong>ìƒì„±ì¼:</strong> ${new Date().toLocaleString('ko-KR')}</p>
                <p><strong>ì´ ì‹ ì²­ì:</strong> ${submissions.length}ëª…</p>
                <hr>
                <h2>êµ¬ë§¤í•´ì•¼ í•  í’ˆëª©</h2>
            `;
            
            Object.keys(ITEM_INFO).forEach(key => {
                if (totals[key] > 0) {
                    printContent += `<p><strong>${ITEM_INFO[key]}:</strong> ${totals[key]}${ITEM_UNITS[key]}</p>`;
                }
            });
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>ë¯¸í™” í’ˆëª© êµ¬ë§¤ ëª©ë¡</title>
                    <style>
                        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; }
                        h1 { color: #4CAF50; }
                        p { font-size: 16px; line-height: 1.6; }
                    </style>
                </head>
                <body>${printContent}</body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function printAll() {
            window.print();
        }
    </script>
</body>
</html>